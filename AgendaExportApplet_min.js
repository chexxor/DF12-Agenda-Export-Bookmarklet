window.speakerStringFromSpeakerArray=function(a){var b="";var c=[];for(var d=0;d<a.length;d++){var e=a[d];var f=e.firstName+" "+e.lastName;c.push(" "+f)}b=c.join(",");return b};window.gcalDateFromSfDate=function(a){var b="";if(a.indexOf("AM")!=-1)b=a.replace("AM"," AM");else if(a.indexOf("PM")!=-1)b=a.replace("PM"," PM");return b};window.zeroFill=function(a,b){b-=a.toString().length;if(b>0){return(new Array(b+(/\./.test(a)?2:1))).join("0")+a}return a+""};window.icalDateTimeFromSfDateAndTime=function(a,b){var c="";var d=a.split("/");var e=d[2];var f=d[0];var g=d[1];var h=false;if(b.indexOf("AM")!=-1){b=b.replace("AM","")}if(b.indexOf("PM")!=-1){b=b.replace("PM","");h=true}var i=b.split(":");var j=i[0];if(h){if(+j<12)j=+j+12}var k=i[1];var l=new Date(e,f,g,j,k);c+=l.getFullYear();c+=window.zeroFill(l.getMonth()+"",2);c+=window.zeroFill(l.getDate()+"",2);c+="T"+window.zeroFill(l.getHours()+"",2);c+=window.zeroFill(l.getMinutes()+"",2);c+=window.zeroFill(l.getSeconds()+"",2);return c};window.icalDateTimeNow=function(){var a="";var b=new Date;a+=b.getFullYear()+"";a+=window.zeroFill(b.getMonth()+"",2);a+=window.zeroFill(b.getDate()+"",2);a+="T"+window.zeroFill(b.getHours()+"",2);a+=window.zeroFill(b.getMinutes()+"",2);a+=window.zeroFill(b.getSeconds()+"",2);return a};window.buildTimezoneComponentString=function(){var a="";a+="BEGIN:VTIMEZONE\r\n";a+="TZID:US-Pacific\r\n";a+="BEGIN:STANDARD\r\n";a+="TZOFFSETFROM:-0700\r\n";a+="TZOFFSETTO:-0800\r\n";a+="DTSTART:19671029T020000\r\n";a+="RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=10\r\n";a+="TZNAME:PST\r\n";a+="END:STANDARD\r\n";a+="BEGIN:DAYLIGHT\r\n";a+="TZOFFSETFROM:-0800\r\n";a+="TZOFFSETTO:-0700\r\n";a+="DTSTART:19870405T020000\r\n";a+="RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=4\r\n";a+="TZNAME:PDT\r\n";a+="END:DAYLIGHT\r\n";a+="END:VTIMEZONE\r\n";return a};window.encodeSpecialChars=function(a){var b=a.replace(/,/g,"\\,");b=b.replace(/;/g,"\\;");return b};window.sessionCsvFromSessionDetails=function(a){var b="";var c=[];var d='"'+a.name+'"';var e=a.day;var f=window.gcalDateFromSfDate(a.startTime);var g=a.day;var h=a.endTime;var i="False";var j='"'+a.shortDescription+" \r\n\nSpeakers:\n"+window.speakerStringFromSpeakerArray(a.speakers)+'"';var k='"'+a.room.location+'"';var l="False";c.push(d);c.push(e);c.push(f);c.push(g);c.push(h);c.push(i);c.push(j);c.push(k);c.push(l);b=c.join(",");return b};window.sessionVeventStringFromSessionDetails=function(a){var b="";var c=[];var d="BEGIN:VEVENT";c.push(d);var e="DTSTAMP:"+window.icalDateTimeNow();c.push(e);if(a.speakers){var f="ORGANIZER:CN="+window.speakerStringFromSpeakerArray(a.speakers);c.push(f)}var g="DTSTART;TZID=US-Pacific:"+window.icalDateTimeFromSfDateAndTime(a.day,a.startTime);c.push(g);var h="DTEND;TZID=US-Pacific:"+window.icalDateTimeFromSfDateAndTime(a.day,a.endTime);c.push(h);if(a.name){var i="SUMMARY:"+window.encodeSpecialChars(a.name);c.push(i)}if(a.shortDescription){var j="DESCRIPTION:"+window.encodeSpecialChars(a.shortDescription)+" \n\nSpeakers:\n"+window.encodeSpecialChars(window.speakerStringFromSpeakerArray(a.speakers));c.push(j)}if(a.room&&a.room.location){var k="LOCATION:"+window.encodeSpecialChars(a.room.location);c.push(k)}if(a.code){var l="URL:"+a.code;c.push(l)}var m="END:VEVENT";c.push(m);b=c.join("\r\n");return b};window.showTextInCloudPanel=function(a){$Cloud.destroyPanel();var b=a.replace(/\r\n/g,"<br>");$("#loadingMask").show().one("click",$Cloud.destroyPanel);var c='<div class="panelHeaderBar fixedBar"><div class="bLeft"></div><div class="bRight"><span class="uiButton submit back">Close</span></div><div class="bBody"><h3 class="flush truncate"> Agenda CSV for Google Calendar </h3></div></div>';var d='<div id="panelScroller2" class="forceScroller"><div id="contentSections" class="padGrid fontSizeSmall"><div class="detailsSection detailsSection0">Copy everything below this line and save it into a new text file on your computer. Use Google Calendar to import this file.</div><div class="detailsSection detailsSection0"><div class="detailsAccordionSection padGrid"><div id="activityDescription" class="alternate fontSizeSmall">DISPLAY_CONTENT_HERE</div></div></div></div></div>';var e='<div id="detailView" style="overflow-y: auto;><div id="detailViewContent" style="opacity: 1;">WRAPPED_ELEMENTS</div></div>';var f=e.replace("WRAPPED_ELEMENTS",c+d);var g=f.replace("DISPLAY_CONTENT_HERE",b);var h=g;$("#panels").append(h);if(!$("#panelScroller2").hasClass("uiScroller")){$Cloud.fixDetailsHeight()}else{$Cloud.refreshScrollers("panelScroller2")}};window.exportAgenda=function(){window.agendaCsvString="";var a="Subject,Start Date,Start Time,End Date,End Time,All Day Event,Description,Location,Private\r\n";window.agendaCsvString+=a;$Cloud.getData({type:"get",method:"getAllEnrollmentsForAllDays",viewHandler:function(a,b){var c=a;for(var d=0;d<c.length;d++){var e=c[d];var f=e.timeslots;for(var g=0;g<f.length;g++){var h=f[g];var i=h.items.length>0;if(i==true){var j=h.items[0];var k=window.sessionCsvFromSessionDetails(j);window.agendaCsvString+=k+"\r\n"}}}window.showTextInCloudPanel(window.agendaCsvString)}})};window.exportAgendaIcal=function(){window.agendaIcalString="";var a="[TOKEN_ICAL_BODY]";var b=/\[TOKEN\_ICAL\_BODY\]/;var c="BEGIN:VCALENDAR\r\n";c+="VERSION:2.0 \r\n";c+="PRODID:-//https://github.com/chexxor/DF12-Agenda-Export-Bookmarklet v1.0//EN\r\n";var d=window.buildTimezoneComponentString();c+=d;c+=a+"\r\n";c+="END:VCALENDAR\r\n";$Cloud.getData({type:"get",method:"getAllEnrollmentsForAllDays",viewHandler:function(a,d){var e=a;var f=[];for(var g=0;g<e.length;g++){var h=e[g];var i=h.timeslots;for(var j=0;j<i.length;j++){var k=i[j];var l=k.items.length>0;if(l==true){var m=k.items[0];var n=window.sessionVeventStringFromSessionDetails(m);f.push(n)}}}var o=f.join("\r\n");window.agendaIcalString=c.replace(b,o);window.showTextInCloudPanel(window.agendaIcalString)}})};window.exportAgendaIcal()
