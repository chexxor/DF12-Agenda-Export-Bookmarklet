var BlobBuilder=BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder||function(a){"use strict";var b=function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},c=function(){this.data=[]},d=function(a,b,c){this.data=a;this.size=a.length;this.type=b;this.encoding=c},e=c.prototype,f=d.prototype,g=a.FileReaderSync,h=function(a){this.code=this[this.name=a]},i=("NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR "+"NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR").split(" "),j=i.length,k=a.URL||a.webkitURL||a,l=k.createObjectURL,m=k.revokeObjectURL,n=k,o=a.btoa,p=a.atob,q=false,r=function(a){q=!a},s=a.ArrayBuffer,t=a.Uint8Array;c.fake=f.fake=true;while(j--){h.prototype[i[j]]=j+1}try{if(t){r.apply(0,new t(1))}}catch(u){}if(!k.createObjectURL){n=a.URL={}}n.createObjectURL=function(a){var b=a.type,c;if(b===null){b="application/octet-stream"}if(a instanceof d){c="data:"+b;if(a.encoding==="base64"){return c+";base64,"+a.data}else if(a.encoding==="URI"){return c+","+decodeURIComponent(a.data)}if(o){return c+";base64,"+o(a.data)}else{return c+","+encodeURIComponent(a.data)}}else if(real_create_object_url){return real_create_object_url.call(k,a)}};n.revokeObjectURL=function(a){if(a.substring(0,5)!=="data:"&&real_revoke_object_url){real_revoke_object_url.call(k,a)}};e.append=function(a){var c=this.data;if(t&&a instanceof s){if(q){c.push(String.fromCharCode.apply(String,new t(a)))}else{var e="",f=new t(a),i=0,j=f.length;for(;i<j;i++){e+=String.fromCharCode(f[i])}}}else if(b(a)==="Blob"||b(a)==="File"){if(g){var k=new g;c.push(k.readAsBinaryString(a))}else{throw new h("NOT_READABLE_ERR")}}else if(a instanceof d){if(a.encoding==="base64"&&p){c.push(p(a.data))}else if(a.encoding==="URI"){c.push(decodeURIComponent(a.data))}else if(a.encoding==="raw"){c.push(a.data)}}else{if(typeof a!=="string"){a+=""}c.push(unescape(encodeURIComponent(a)))}};e.getBlob=function(a){if(!arguments.length){a=null}return new d(this.data.join(""),a,"raw")};e.toString=function(){return"[object BlobBuilder]"};f.slice=function(a,b,c){var e=arguments.length;if(e<3){c=null}return new d(this.data.slice(a,e>1?b:this.data.length),c,this.encoding)};f.toString=function(){return"[object Blob]"};return c}(self);var saveAs=saveAs||function(a){"use strict";var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=a.URL||a.webkitURL||a,e=b.createElementNS("http://www.w3.org/1999/xhtml","a"),f="download"in e,g=function(c){var d=b.createEvent("MouseEvents");d.initMouseEvent("click",true,false,a,0,0,0,0,0,false,false,false,false,0,null);return c.dispatchEvent(d)},h=a.webkitRequestFileSystem,i=a.requestFileSystem||h||a.mozRequestFileSystem,j=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},k="application/octet-stream",l=0,m=[],n=function(){var a=m.length;while(a--){var b=m[a];if(typeof b==="string"){d.revokeObjectURL(b)}else{b.remove()}}m.length=0},o=function(a,b,c){b=[].concat(b);var d=b.length;while(d--){var e=a["on"+b[d]];if(typeof e==="function"){try{e.call(a,c||a)}catch(f){j(f)}}}},p=function(b,d){var j=this,n=b.type,p=false,q,r,s=function(){var a=c().createObjectURL(b);m.push(a);return a},t=function(){o(j,"writestart progress write writeend".split(" "))},u=function(){if(p||!q){q=s(b)}r.location.href=q;j.readyState=j.DONE;t()},v=function(a){return function(){if(j.readyState!==j.DONE){return a.apply(this,arguments)}}},w={create:true,exclusive:false},x;j.readyState=j.INIT;if(!d){d="download"}if(f){q=s(b);e.href=q;e.download=d;if(g(e)){j.readyState=j.DONE;t();return}}if(a.chrome&&n&&n!==k){x=b.slice||b.webkitSlice;b=x.call(b,0,b.size,k);p=true}if(h&&d!=="download"){d+=".download"}if(n===k||h){r=a}else{r=a.open()}if(!i){u();return}l+=b.size;i(a.TEMPORARY,l,v(function(a){a.root.getDirectory("saved",w,v(function(a){var c=function(){a.getFile(d,w,v(function(a){a.createWriter(v(function(c){c.onwriteend=function(b){r.location.href=a.toURL();m.push(a);j.readyState=j.DONE;o(j,"writeend",b)};c.onerror=function(){var a=c.error;if(a.code!==a.ABORT_ERR){u()}};"writestart progress write abort".split(" ").forEach(function(a){c["on"+a]=j["on"+a]});c.write(b);j.abort=function(){c.abort();j.readyState=j.DONE};j.readyState=j.WRITING}),u)}),u)};a.getFile(d,{create:false},v(function(a){a.remove();c()}),v(function(a){if(a.code===a.NOT_FOUND_ERR){c()}else{u()}}))}),u)}),u)},q=p.prototype,r=function(a,b){return new p(a,b)};q.abort=function(){var a=this;a.readyState=a.DONE;o(a,"abort")};q.readyState=q.INIT=0;q.WRITING=1;q.DONE=2;q.error=q.onwritestart=q.onprogress=q.onwrite=q.onabort=q.onerror=q.onwriteend=null;a.addEventListener("unload",n,false);return r}(self);window.speakerStringFromSpeakerArray=function(a){var b="";var c=[];for(var d=0;d<a.length;d++){var e=a[d];var f=e.name;c.push(" "+f)}b=c.join(",");return b};window.gcalDateFromSfDate=function(a){var b="";if(a.indexOf("AM")!=-1)b=a.replace("AM"," AM");else if(a.indexOf("PM")!=-1)b=a.replace("PM"," PM");return b};window.sessionCsvFromSessionDetails=function(a){var b="";var c=[];var d='"'+a.name+'"';var e=a.day;var f=window.gcalDateFromSfDate(a.startTime);var g=a.day;var h=a.endTime;var i="False";var j='"'+a.shortDescription+" \r\n\nSpeakers:\n"+window.speakerStringFromSpeakerArray(a.speakers)+'"';var k='"'+a.room.location+'"';var l="False";c.push(d);c.push(e);c.push(f);c.push(g);c.push(h);c.push(i);c.push(j);c.push(k);c.push(l);b=c.join(",");return b};window.showTextInCloudPanel=function(a){$Cloud.destroyPanel();var b=a.replace(/\r\n/g,"<br>");$("#loadingMask").show().one("click",$Cloud.destroyPanel);var c='<div class="panelHeaderBar fixedBar"><div class="bLeft"></div><div class="bRight"><span class="uiButton submit back">Close</span></div><div class="bBody"><h3 class="flush truncate"> Agenda CSV for Google Calendar </h3></div></div>';var d='<div id="panelScroller2" class="forceScroller"><div id="contentSections" class="padGrid fontSizeSmall"><div class="detailsSection detailsSection0">Copy everything below this line and save it into a new text file on your computer. Use Google Calendar to import this file.</div><div class="detailsSection detailsSection0"><div class="detailsAccordionSection padGrid"><div id="activityDescription" class="alternate fontSizeSmall">DISPLAY_CONTENT_HERE</div></div></div></div></div>';var e='<div id="detailView" style="overflow-y: auto;><div id="detailViewContent" style="opacity: 1;">WRAPPED_ELEMENTS</div></div>';var f=e.replace("WRAPPED_ELEMENTS",c+d);var g=f.replace("DISPLAY_CONTENT_HERE",b);var h=g;$("#panels").append(h);if(!$("#panelScroller2").hasClass("uiScroller")){$Cloud.fixDetailsHeight()}else{$Cloud.refreshScrollers("panelScroller2")}};window.exportGoogleCsvAgenda=function(){window.agendaCsvString="";var a="Subject,Start Date,Start Time,End Date,End Time,All Day Event,Description,Location,Private\r\n";window.agendaCsvString+=a;$Cloud.getData({type:"get",method:"getAllEnrollmentsForAllDays",viewHandler:function(a,b){var c=a;for(var d=0;d<c.length;d++){var e=c[d];var f=e.timeslots;for(var g=0;g<f.length;g++){var h=f[g];var i=h.items.length>0;if(i==true){var j=h.items[0];var k=window.sessionCsvFromSessionDetails(j);window.agendaCsvString+=k+"\r\n"}}}var l=new BlobBuilder;l.append(window.agendaCsvString);saveAs(l.getBlob("text/plain;charset=utf-8"),"AgendaGoogleCsvExport.csv")}})};window.exportGoogleCsvAgenda()